<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayush Hub Pro - Final Fixed</title>
    <style>
        :root { --primary: #38bdf8; --bg: #0b111a; --card: #1e293b; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: white; text-align: center; overflow: hidden; }

        /* Loader */
        #update-screen { position: fixed; top:0; left:0; width:100%; height:100%; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .loader-bar { width: 80%; height: 12px; background: #1e293b; border-radius: 10px; margin-top: 20px; overflow: hidden; border: 1px solid var(--primary); }
        .progress { width: 0%; height: 100%; background: var(--primary); transition: 0.1s linear; }

        /* App UI */
        .header { background: #161e2b; padding: 15px; border-bottom: 2px solid var(--primary); display: flex; justify-content: space-between; align-items: center; }
        .coin-box { background: #000; padding: 5px 15px; border-radius: 20px; color: #fbbf24; border: 1px solid #fbbf24; font-weight: bold; }
        .container { padding: 20px; height: 80vh; overflow-y: auto; padding-bottom: 120px; }
        .section { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }

        /* Arjun Game Stage */
        #gun-stage { background: #000; height: 380px; width: 100%; position: relative; border: 2px solid var(--primary); border-radius: 20px; overflow: hidden; }
        .target { position: absolute; font-size: 45px; cursor: pointer; user-select: none; }
        .stats-row { width:100%; display:flex; justify-content: space-between; margin-bottom:10px; font-weight:bold; }

        /* Tic Tac Toe */
        .mode-btn { padding: 8px 15px; background: #1e293b; border: 1px solid var(--primary); color: white; border-radius: 5px; cursor: pointer; margin: 5px; }
        .mode-active { background: var(--primary); color: #000; font-weight: bold; }
        .ttt-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 280px; margin-top: 10px; }
        .ttt-cell { aspect-ratio: 1; background: var(--card); border: 2px solid var(--primary); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; cursor: pointer; height: 85px; }

        /* Footer Nav */
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: #161e2b; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #334155; }
        .nav-btn { background: none; border: none; color: #94a3b8; cursor: pointer; font-size: 0.8rem; }
        .nav-active { color: var(--primary); font-weight: bold; }

        /* Policy Links */
        .policy-link { color: var(--primary); text-decoration: none; font-size: 0.8rem; margin: 10px; cursor: pointer; opacity: 0.7; }
    </style>
</head>
<body onload="checkUpdate()">

    <div id="update-screen" style="display: none;">
        <h2 style="color: var(--primary);">SYSTEM UPDATE...</h2>
        <div class="loader-bar"><div id="progress" class="progress"></div></div>
        <p id="mb-text">0.00 / 2.00 MB</p>
    </div>

    <div id="main-app" style="display: none;">
        <div class="header">
            <div style="font-weight: bold;">AYUSH HUB PRO</div>
            <div class="coin-box">üí∞ <span id="coin-val">0</span></div>
        </div>

        <div class="container">
            <div id="read-sec" class="section active">
                <div style="font-size: 1.1rem; margin-bottom: 10px;">Next in: <span id="timer" style="color:var(--primary)">45</span>s</div>
                <div style="background:var(--card); padding:20px; border-radius:20px; text-align:left; border:1px solid #334155;">
                    <p id="text-display">Loading...</p>
                </div>
                <button onclick="speakText()" style="background:var(--primary); border:none; width:50px; height:50px; border-radius:50%; margin-top:15px; cursor:pointer; font-size:1.5rem;">üîä</button>
                <div style="margin-top:20px;">
                    <span class="policy-link" onclick="alert('Privacy Policy: No data is collected.')">Privacy Policy</span>
                    <span class="policy-link" onclick="alert('About Us: Educational platform for kids.')">About Us</span>
                </div>
            </div>

            <div id="ttt-sec" class="section">
                <div style="display: flex;">
                    <button id="m-ai" class="mode-btn mode-active" onclick="setTTTMode('ai')">Vs AI</button>
                    <button id="m-p2" class="mode-btn" onclick="setTTTMode('p2')">Vs Player 2</button>
                </div>
                <div id="ttt-grid" class="ttt-grid"></div>
                <button onclick="resetTTT()" style="margin-top:20px; padding:10px 20px; background:red; border:none; color:white; border-radius:5px;">Restart</button>
            </div>

            <div id="gun-sec" class="section">
                <div class="stats-row">
                    <span style="color:#ff4444;">‚ù§Ô∏è Life: <span id="lives">10</span></span>
                    <span>Kills: <span id="kills" style="color:var(--primary)">0</span> / 10000</span>
                </div>
                <div id="gun-stage"></div>
                <p style="margin-top:10px; font-size:0.8rem; color:#94a3b8;">Dushman ko niche girne se pehle maaro!</p>
            </div>
        </div>

        <div class="nav-bar">
            <button id="nav-read" class="nav-btn nav-active" onclick="tab('read-sec')">üìñ Read</button>
            <button id="nav-ttt" class="nav-btn" onclick="tab('ttt-sec'); resetTTT();">üéÆ Games</button>
            <button id="nav-gun" class="nav-btn" onclick="tab('gun-sec'); startGun();">üî´ Arjun</button>
        </div>
    </div>

<script>
    let coins = 0, timeLeft = 45, killCount = 0, lives = 10, gunActive = false, spawnInterval;
    let tttBoard = [], turn = "X", tttActive = true, tttMode = "ai", usedIdx = [];

    const paras = [
        "Education is the most powerful weapon which you can use to change the world.",
        "‡§∏‡§´‡§≤‡§§‡§æ ‡§ï‡§æ ‡§Ö‡§∏‡§≤‡•Ä ‡§Æ‡§Ç‡§§‡•ç‡§∞ ‡§ï‡§°‡§º‡•Ä ‡§Æ‡•á‡§π‡§®‡§§ ‡§î‡§∞ ‡§ß‡•à‡§∞‡•ç‡§Ø ‡§π‡•à‡•§ ‡§∞‡•ã‡§ú‡§º‡§æ‡§®‡§æ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§¶‡§§ ‡§°‡§æ‡§≤‡•á‡§Ç‡•§",
        "Kindness costs nothing but means everything. Always help others in need.",
        "Health is the greatest gift. Exercise daily and eat healthy food to stay sharp."
    ];

    function checkUpdate() {
        if(localStorage.getItem('ayush_vFinal_Fixed')) { startApp(); }
        else {
            document.getElementById('update-screen').style.display = 'flex';
            let p = 0;
            let iv = setInterval(() => {
                p += 2; document.getElementById('progress').style.width = p + "%";
                document.getElementById('mb-text').innerText = ((p/100)*2).toFixed(2) + " / 2.00 MB";
                if(p >= 100) { clearInterval(iv); localStorage.setItem('ayush_vFinal_Fixed', 'true'); startApp(); }
            }, 40);
        }
    }

    function startApp() {
        document.getElementById('update-screen').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
        loadPara(); setInterval(timerLogic, 1000);
    }

    function loadPara() {
        if(usedIdx.length === paras.length) usedIdx = [];
        let r; do { r = Math.floor(Math.random()*paras.length); } while(usedIdx.includes(r));
        usedIdx.push(r); document.getElementById('text-display').innerText = paras[r];
        timeLeft = 45;
    }

    function timerLogic() {
        if(document.getElementById('read-sec').classList.contains('active')) {
            timeLeft--; document.getElementById('timer').innerText = timeLeft;
            if(timeLeft <= 0) { coins += 20; document.getElementById('coin-val').innerText = coins; loadPara(); }
        }
    }

    function speakText() {
        window.speechSynthesis.cancel();
        let ut = new SpeechSynthesisUtterance(document.getElementById('text-display').innerText);
        ut.lang = (/[‡§Ö-‡§π]/.test(ut.text)) ? 'hi-IN' : 'en-US';
        window.speechSynthesis.speak(ut);
    }

    function setTTTMode(m) { tttMode = m; resetTTT(); 
        document.getElementById('m-ai').className = (m=='ai') ? 'mode-btn mode-active' : 'mode-btn';
        document.getElementById('m-p2').className = (m=='p2') ? 'mode-btn mode-active' : 'mode-btn';
    }

    function resetTTT() {
        tttBoard = Array(9).fill(""); turn = "X"; tttActive = true;
        const grid = document.getElementById('ttt-grid'); grid.innerHTML = "";
        for(let i=0; i<9; i++) {
            let c = document.createElement('div'); c.className = 'ttt-cell';
            c.onclick = () => {
                if(tttBoard[i]=="" && tttActive) {
                    tttBoard[i] = turn; c.innerText = turn;
                    if(checkW()) return;
                    turn = (turn=="X") ? "O" : "X";
                    if(tttMode == "ai" && turn == "O" && tttActive) setTimeout(aiMove, 500);
                }
            }; grid.appendChild(c);
        }
    }

    function aiMove() {
        let empty = tttBoard.map((v,i)=>v==""?i:null).filter(v=>v!==null);
        if(empty.length > 0 && tttActive) {
            let idx = empty[Math.floor(Math.random()*empty.length)];
            document.getElementsByClassName('ttt-cell')[idx].click();
        }
    }

    function checkW() {
        let win = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
        for(let p of win) {
            if(tttBoard[p[0]]!="" && tttBoard[p[0]]==tttBoard[p[1]] && tttBoard[p[1]]==tttBoard[p[2]]) {
                alert(tttBoard[p[0]] + " Wins!"); tttActive = false; return true;
            }
        }
        return false;
    }

    // --- ARJUN GAME STABLE ---
    function startGun() {
        document.getElementById('gun-stage').innerHTML = ""; 
        killCount = 0; lives = 10; gunActive = true;
        document.getElementById('kills').innerText = "0";
        document.getElementById('lives').innerText = lives;
        clearInterval(spawnInterval); spawnInterval = setInterval(createT, 1200);
    }

    function createT() {
        if(!gunActive) return;
        let t = document.createElement('div'); t.className = 'target'; t.innerText = "üëπ";
        t.style.left = Math.random()*85 + "%"; t.style.top = "-50px";
        document.getElementById('gun-stage').appendChild(t);
        let fall = setInterval(() => {
            let top = parseInt(t.style.top);
            if(top > 330) { 
                clearInterval(fall); t.remove(); 
                if(gunActive) { 
                    lives--; document.getElementById('lives').innerText = lives;
                    if(lives <= 0) { gunActive = false; alert("Game Over! Kills: " + killCount); startGun(); }
                }
            } else if(!gunActive) { clearInterval(fall); t.remove(); }
            else { t.style.top = (top + 4) + "px"; }
        }, 40);
        t.onclick = () => { t.innerText="üí•"; killCount++; document.getElementById('kills').innerText = killCount; setTimeout(()=>t.remove(),100); };
    }

    function tab(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('nav-active'));
        document.getElementById(id).classList.add('active');
        document.getElementById('nav-' + id.split('-')[0]).classList.add('nav-active');
        gunActive = (id === 'gun-sec'); 
        if(!gunActive) { clearInterval(spawnInterval); document.getElementById('gun-stage').innerHTML = ""; }
    }
</script>
</body>
</html>
